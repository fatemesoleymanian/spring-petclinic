<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout (~{::body},'pets')}">

<body>

<h2>Find Pets</h2>

<!-- Search Form -->
<form class="form-horizontal" method="get" th:action="@{/pets/find}">
  <div class="form-group">

    <div class="control-group">
      <label class="col-sm-2 control-label">Pet Name</label>
      <div class="col-sm-10">
        <input class="form-control" name="petName" placeholder="Pet name" th:value="${param.petName}"/>
      </div>
    </div>

  </div>

  <div class="form-group mt-3">
    <button type="submit" class="btn btn-primary">Find</button>
  </div>
</form>

<hr/>

<div th:if="${pets != null}">
  <table class="table table-striped" th:if="${#lists.size(pets) > 0}">
    <thead>
    <tr>
      <th>Pet Name</th>
      <th>Type</th>
      <th>Birth Date</th>
      <th>Visits Count</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="pet : ${pets}">
      <td th:text="${pet.name}"></td>
      <td th:text="${pet.type.name}"></td>
      <td th:text="${pet.birthDate}"></td>
      <td th:text="${#lists.size(pet.visits)}"></td>
    </tr>
    </tbody>
  </table>

  <!-- Pagination -->
  <div class="pagination">
    <ul>

      <li th:if="${currentPage > 0}">
        <a th:href="@{/pets/find(page=${currentPage - 1}, petName=${param.petName})}">Prev</a>
      </li>

      <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:text="${i+1}"
           th:href="@{/pets/find(page=${i}, petName=${param.petName})}"
           th:classappend="${i==currentPage} ? 'active'"></a>
      </li>

      <li th:if="${currentPage < totalPages - 1}">
        <a th:href="@{/pets/find(page=${currentPage+1}, petName=${param.petName})}">Next</a>
      </li>

    </ul>
  </div>

  <p th:if="${#lists.isEmpty(pets)}" class="text-danger">No pets found.</p>
</div>

</body>
</html>
